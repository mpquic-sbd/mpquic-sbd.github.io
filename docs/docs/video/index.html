<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-GB" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Prepare the video files - MPQUIC-SBD</title>
<meta name="description" content="Instructions for running the Vagrant VM.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_GB">
<meta property="og:site_name" content="MPQUIC-SBD">
<meta property="og:title" content="Prepare the video files">
<meta property="og:url" content="http://localhost:4000/docs/video/">


  <meta property="og:description" content="Instructions for running the Vagrant VM.">







  <meta property="article:published_time" content="2024-12-26T18:29:13-05:00">






<link rel="canonical" href="http://localhost:4000/docs/video/">







  <meta name="google-site-verification" content="UQj93ERU9zgECodaaXgVpkjrFn9UrDMEzVamacSoQ8Y" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="MPQUIC-SBD Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          MPQUIC-SBD
          <span class="site-subtitle">MultiPath QUIC with Shared Bottleneck Detection</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/docs/howto/"
                
                
              >Quick-Start Guide</a>
            </li><li class="masthead__menu-item">
              <a
                href="/publications/"
                
                
              >Publications</a>
            </li><li class="masthead__menu-item">
              <a
                href="/acknowledgement/"
                
                
              >Acknowledgement</a>
            </li><li class="masthead__menu-item">
              <a
                href="/lab/"
                
                
              >PANDA lab</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      <nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      
      
        <li>
          
            <span class="nav__sub-title">Getting Started</span>
          

          
          <ul>
            
              <li><a href="/docs/installation/">Install the experimental setup</a></li>
            
              <li><a href="/docs/video/" class="active">Prepare the video files</a></li>
            
              <li><a href="/docs/video-server/">Configure the video server</a></li>
            
              <li><a href="/docs/run-client-server/">Run the video server application</a></li>
            
          </ul>
          
        </li>
      
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Prepare the video files">
    <meta itemprop="description" content="Instructions for running the Vagrant VM.">
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://localhost:4000/docs/video/" itemprop="url">Prepare the video files
</a>
          </h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#offline-enconding-of-video-segments">Offline enconding of video segments</a><ul><li><a href="#step-1-requirements">Step 1: Requirements</a></li><li><a href="#step-2-enconding-the-video">Step 2: Enconding the video</a></li><li><a href="#step-3-creating-video-segments-and-mpd-file">Step 3: Creating Video Segments and MPD File</a></li><li><a href="#step-4-providing-a-video-folder-for-the-video-server">Step 4: Providing a video folder for the video server</a></li></ul></li></ul>
            </nav>
          </aside>
        
        <h3 id="offline-enconding-of-video-segments">Offline enconding of video segments</h3>

<p>In the <code class="language-plaintext highlighter-rouge">example</code> <a href="https://github.com/thomaswpp/mpquic-sbd/tree/master/example">folder</a>, you will find example files and code for creating segments and generating MPD representations. Following the three steps below offers an easy way to run MPQUIC-SBD.</p>

<p class="notice--info"><strong>Note:</strong> Video preparation is an offline process that may take significant time depending on the video’s length. We recommend performing this process outside the Vagrant VM, e.g., on your host system, which likely has greater computational resources.</p>

<hr />
<h4 id="step-1-requirements">Step 1: Requirements</h4>

<p>First, install <code class="language-plaintext highlighter-rouge">MP4Box</code> and <code class="language-plaintext highlighter-rouge">ffmpeg</code> on your host system.</p>

<p><strong>Warning:</strong> we are using the following versions:</p>
<ul class="notice--warning">
  <li><strong><code class="language-plaintext highlighter-rouge">MP4Box</code> - GPAC version <code class="language-plaintext highlighter-rouge">2.0-rev2.0.0+dfsg1-2</code></strong></li>
  <li><strong><code class="language-plaintext highlighter-rouge">ffmpeg</code> version <code class="language-plaintext highlighter-rouge">4.4.3-0ubuntu1~20.04.sav1</code></strong></li>
</ul>

<hr />
<h4 id="step-2-enconding-the-video">Step 2: Enconding the video</h4>

<p>To encode an mp4 video into videos of other formats and sizes, we use <code class="language-plaintext highlighter-rouge">ffmpgeg</code>. The following command example converts a 4k 60 fps video to a 240 MB 25 fps video.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg <span class="nt">-y</span> <span class="nt">-i</span> 4k60fps.mp4 <span class="se">\</span>
<span class="nt">-c</span>:a aac <span class="nt">-ac</span> 2 <span class="nt">-ab</span> 128k <span class="nt">-c</span>:v libx264 <span class="se">\</span>
<span class="nt">-x264opts</span> <span class="s1">'keyint=96:min-keyint=96:no-scenecut'</span> <span class="se">\</span>
<span class="nt">-b</span>:v 250k <span class="nt">-maxrate</span> 500k <span class="nt">-bufsize</span> 1000k <span class="nt">-s</span> 426x240 <span class="se">\ </span>
<span class="nt">-vf</span> <span class="nv">scale</span><span class="o">=</span>426x240 <span class="nt">-filter</span>:v <span class="nv">fps</span><span class="o">=</span>25 video_240_25fps.mp4 &amp; 
</code></pre></div></div>

<hr />
<h4 id="step-3-creating-video-segments-and-mpd-file">Step 3: Creating Video Segments and MPD File</h4>

<p>After converting the videos to the desired formats, the next step is to segment them and generate the MPD file. The following example command creates 4-second video segments along with their corresponding representation.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MP4Box <span class="nt">-dash</span> 4000 <span class="se">\</span>
<span class="nt">-segment-name</span> <span class="s1">'segment_$RepresentationID$_'</span> <span class="se">\</span>
<span class="nt">-mpd-refresh</span> 4 <span class="se">\</span>
<span class="nt">-fps</span> 25 video_240_25fps.mp4#video:id<span class="o">=</span>240p <span class="se">\</span>
<span class="nt">-fps</span> 25 video_360_25fps.mp4#video:id<span class="o">=</span>360p <span class="se">\</span>
<span class="nt">-fps</span> 25 video_480_25fps.mp4#video:id<span class="o">=</span>480p <span class="se">\</span>
<span class="nt">-fps</span> 25 video_720_25fps.mp4#video:id<span class="o">=</span>720p <span class="se">\</span>
<span class="nt">-fps</span> 60 video_720_60fps.mp4#video:id<span class="o">=</span>7202p <span class="se">\</span>
<span class="nt">-fps</span> 25 video_1080_25fps.mp4#video:id<span class="o">=</span>1080p <span class="se">\</span>
<span class="nt">-fps</span> 60 video_1080_60fps.mp4#video:id<span class="o">=</span>10802p <span class="se">\</span>
<span class="nt">-fps</span> 30 video_1440_30fps.mp4#video:id<span class="o">=</span>1440p <span class="se">\</span>
<span class="nt">-fps</span> 60 video_1440_60fps.mp4#video:id<span class="o">=</span>14402p <span class="se">\</span>
<span class="nt">-fps</span> 30 video_2160_30fps.mp4#video:id<span class="o">=</span>2560p <span class="se">\</span>
<span class="nt">-fps</span> 60 video_2160_60fps.mp4#video:id<span class="o">=</span>25602p <span class="se">\</span>
<span class="nt">-out</span> output_dash.mpd
</code></pre></div></div>

<p>The <a href="https://github.com/thomaswpp/mpquic-sbd/blob/master/src/AStream/dist/client/adaptation/weighted_dash.py">SARA ABR algorithm</a> requires the representation to include additional information for each segment, which <code class="language-plaintext highlighter-rouge">MP4Box</code> does not provide. To address this, a Python script was developed to modify the standard MPD generated by MP4Box into a format compatible with the SARA algorithm.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python modify_mpd.py 
</code></pre></div></div>

<p><strong>Note:</strong> The new MPD for the SARA ABR algorithm is saved as <code class="language-plaintext highlighter-rouge">output_dash.mpd</code>, located in the same folder as <code class="language-plaintext highlighter-rouge">modify_mpd.py</code>.</p>

<h4 id="step-4-providing-a-video-folder-for-the-video-server">Step 4: Providing a video folder for the video server</h4>

<p>In the <code class="language-plaintext highlighter-rouge">mpquic-sbd-vagrant</code> folder, there is a <code class="language-plaintext highlighter-rouge">Workstation</code> folder that is shared between your host and the Vagrant VM. You can create a folder inside <code class="language-plaintext highlighter-rouge">Workstation</code> (e.g., <code class="language-plaintext highlighter-rouge">Workstation/videos</code>) and move all the created segment files into it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── /Workstation
|   ├── mpquic-sbd   <span class="c"># Source files of the experimental setup</span>
|   ├── videos       <span class="c"># You can create a folder like this to store all your video files</span>
</code></pre></div></div>


        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/docs/video-server/" class="pagination--pager" title="Configure the video server">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>


    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><div class="search-searchbar"></div>
  <div class="search-hits"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/mpquic-sbd/mpquic-sbd" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="http://localhost:4000">MPQUIC-SBD</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>


<script>
// Including InstantSearch.js library and styling
const loadSearch = function() {
  const loadCSS = function(src) {
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = src;
    link.media = 'all';
    document.head.appendChild(link);
  };

  var script = document.createElement('script');
  script.setAttribute("type", "text/javascript");
  script.setAttribute("src", "https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.js");
  script.addEventListener("load", function() {
    // Instantiating InstantSearch.js with Algolia credentials
    const search = instantsearch({
      appId: 'QB6HVGBSBA',
      apiKey: '9d5014e5bbc77372547bce778dfa5663',
      indexName: 'minimal_mistakes',
      searchParameters: {
        restrictSearchableAttributes: ['title', 'content']
      }
    });

    const hitTemplate = function(hit) {
      const url = hit.url;
      const hightlight = hit._highlightResult;
      const title = hightlight.title && hightlight.title.value  || "";
      const content = hightlight.html && hightlight.html.value  || "";

      return `
        <div class="list__item">
          <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
            <h2 class="archive__item-title" itemprop="headline"><a href="/${url}">${title}</a></h2>
            <div class="archive__item-excerpt" itemprop="description">${content}</div>
          </article>
        </div>
      `;
    }

    // Adding searchbar and results widgets
    search.addWidget(
      instantsearch.widgets.searchBox({
        container: '.search-searchbar',
        poweredBy: true,
        placeholder: 'Enter your search term...'
      })
    );
    search.addWidget(
      instantsearch.widgets.hits({
        container: '.search-hits',
        templates: {
          item: hitTemplate,
          empty: 'No results',
        }
      })
    );

    if (!search.started) {
      search.start();
    }
  });
  document.body.appendChild(script);

  loadCSS("https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch.min.css");
  loadCSS("https://cdn.jsdelivr.net/npm/instantsearch.js@2.3.3/dist/instantsearch-theme-algolia.min.css");
};

// Starting the search only when toggle is clicked
$(document).ready(function() {
  var scriptLoaded = false;

  $(".search__toggle").on("click", function() {
    if (!scriptLoaded) {
      loadSearch();
      scriptLoaded = true;
    }
  });
});
</script>







  </body>
</html>
